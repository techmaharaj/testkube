apiVersion: cli.kyverno.io/v1alpha1
kind: Test
metadata:
  name: general-tests
policies:
  - disallow-latest-tag.yaml
  - restrict-image-registries.yaml
resources:
  - ../resources/deployment-wo-limits.yaml
  - ../resources/job-wo-ttl.yaml
  - ../resources/pod-with-limits.yaml
results:
  - policy: disallow-latest-tag
    rule: validate-image-tag
    resource: nginx-deployment
    kind: Deployment
    result: pass
  - policy: restrict-image-registries
    rule: validate-registries
    resource: nginx-deployment
    kind: Deployment
    result: pass
  - policy: restrict-image-registries
    rule: validate-registries
    resource: web
    kind: Pod
    result: pass
